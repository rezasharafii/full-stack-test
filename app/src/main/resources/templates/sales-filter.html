<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layout :: layout(~{::body})}">
<body>
<div
     style="display: flex; flex-direction: column; gap: var(--wa-space-l);">

    <div class="card">
        <h4 style="margin: 0;">Sales Filters</h4>

        <form id="sales-filter-form"
              hx-get="/sales/filter"
              hx-target="#main-content"
              hx-select="#main-content"
              hx-swap="outerMorph"
              hx-push-url="true"
              hx-trigger="change delay:200ms, submit"
              style="margin: 10px 0">

            <wa-input id="filter-product-title"
                      name="productTitle"
                      label="Product Title"
                      placeholder="Filter by product name"
                      th:value="${productTitle}"
                      style="flex-grow: 1;">
            </wa-input>


        </form>
        <wa-button variant="neutral"
                   size="small"
                   hx-get="/sales/filter"
                   hx-params="none"
                   th:type="button"
                   hx-target="#main-content"
                   hx-select="#main-content"
                   hx-swap="outerMorph"
                   hx-push-url="true"
                   style="margin-top: var(--wa-space-m);"
        >
            Reset
        </wa-button>
    </div>

    <div id="sales-financial-cards" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: var(--wa-space-m); margin-bottom: var(--wa-space-xl);">
        <div class="card" style=" background: var(--wa-color-brand-95);">
            <small>Monthly Revenue</small>
            <h2>
                <wa-format-number type="currency" currency="USD" th:value="${summary.totalRevenue}"
                                  lang="en-US"></wa-format-number>
            </h2>
        </div>
        <div class="card">
            <small>Tax Collected</small>
            <h2>
                <wa-format-number type="currency" currency="USD" th:value="${summary.totalTax}"
                                  lang="en-US"></wa-format-number>
            </h2>
        </div>
        <div class="card">
            <small>Transactions</small>
            <h2 th:text="${summary.salesCount}">0</h2>
        </div>
    </div>
    <div id="sales-table-container" class="card"
         style=" padding: 0px; max-height: 450px; overflow: hidden; overflow-y: auto; border-radius: var(--wa-border-radius-m); box-shadow: var(--wa-shadow-l) ">
        <!-- No results -->
        <div th:if="${#lists.isEmpty(summary.sales)}"
             style="padding: var(--wa-space-xl);
                text-align: center;
                color: var(--wa-color-neutral-50);">

            <wa-icon name="search" style="font-size: 2rem; margin-bottom: var(--wa-space-s);"></wa-icon>

            <p style="margin: 0;">
                No Sales found matching your search.
            </p>
        </div>
        <table id="sales-filter-table"   style="width: 100%; border-collapse: collapse; font-size: var(--wa-font-size-s);" th:if="${!#lists.isEmpty(summary.sales)}">
            <thead style="position: sticky; top: 0; z-index: 10; background-color: var(--wa-color-neutral-95); box-shadow: inset 0 -1px 0 var(--wa-color-neutral-90);">
            <tr>
                <th style="text-align: left; padding: var(--wa-space-m);">Product</th>
                <th style="text-align: left; padding: var(--wa-space-m);">SKU</th>
                <th style="text-align: left; padding: var(--wa-space-m);">Quantity</th>
                <th style="text-align: right; padding: var(--wa-space-m);">Total</th>
                <th style="text-align: right; padding: var(--wa-space-m);">Date</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="sale : ${summary.sales}"
                style="border-bottom: 1px solid var(--wa-color-neutral-80); transition: background-color 0.2s;"
                hx-swap-oob="true"
                onmouseover="this.style.backgroundColor='var(--wa-color-neutral-90)'"
                onmouseout="this.style.backgroundColor='transparent'">
                <td style="padding: var(--wa-space-m);" th:text="${sale.productTitle}">Title</td>
                <td style="padding: var(--wa-space-m);" th:text="${sale.sku}">SKU</td>
                <td style="padding: var(--wa-space-m);" th:text="${sale.quantity}">Quantity</td>
                <td style="padding: var(--wa-space-m); text-align: right; font-weight: bold;">
                    <wa-format-number
                            type="currency"
                            currency="USD"
                            th:attr="value=${sale.totalAmount}"
                            lang="en-US">
                    </wa-format-number>
                </td>
                <td style="padding: var(--wa-space-m); text-align: right; color: var(--wa-color-neutral-50);">
                    <wa-format-date month="numeric" day="numeric" year="numeric" hour="numeric" minute="numeric"
                                    th:date="${sale.soldAt}"></wa-format-date>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</div>

</body>
</html>
